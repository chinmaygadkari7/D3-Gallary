<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Map</title>
    <style>
    </style>

    <script src="https://d3js.org/d3.v5.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
  </head>
  <body>
    <select>
    <svg></svg>
    <script>

      Promise.all([
          d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson"),
          d3.json("data.json")
        ]
      ).then(mapView)


      function mapView(values) {
        console.log("Loading page....")
        var worldmap = values[0];
        var data = values[1];

        const  width = 1024;
        const height = 512;

        // SVG element
        var svg = d3.select("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .style("background-color", "b3d9ff");

        // Projection for map
        var projection = d3.geoMercator()
                           .scale(150)
                           .center([0,40])
                           .translate([width / 2, height / 2]);

        // add map
        svg.append("g")
           .selectAll("path")
           .data(worldmap.features)
           .enter()
           .append("path")
           .attr("d", d3.geoPath().projection(projection))
           .attr("fill", "#ffffe6");

        // add coordinates for all sites
        var allSites = svg.append("g")
                          .selectAll("circle")
                          .data(data.location)
                          .enter()
                          .append("circle")
                          .attr("cx", function(d){ return projection([d.Longitude, d.Latitude])[0] })
                          .attr("cy", function(d){ return projection([d.Longitude, d.Latitude])[1] })
                          .attr("r", "1.5px")
                          .attr("fill", "red");

        // zoom
        var zoom = d3.zoom()
                     .scaleExtent([1, 8])
                     .on('zoom', function() {
                       svg.selectAll("g")
                          .attr('transform', d3.event.transform);
                      });

       svg.call(zoom);
      }



</script>


  </body>
</html>
